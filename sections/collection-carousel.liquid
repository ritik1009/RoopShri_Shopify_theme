{% schema %}
{
  "name": "Popular Categories Column",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Popular Categories"
    },
    {
      "type": "select",
      "id": "title_alignment",
      "label": "Title Alignment",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "title_size",
      "label": "Section Title Font Size (px)",
      "min": 16,
      "max": 48,
      "step": 1,
      "default": 28
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#111111"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Category Title Color",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "title_font_size",
      "label": "Category Title Font Size (px)",
      "min": 12,
      "max": 28,
      "step": 1,
      "default": 16
    },
    {
      "type": "range",
      "id": "image_size",
      "label": "Image Size (px)",
      "min": 60,
      "max": 250,
      "step": 10,
      "default": 100
    },
    {
      "type": "select",
      "id": "image_shape",
      "label": "Image Shape",
      "options": [
        { "value": "circle", "label": "Circle" },
        { "value": "square", "label": "Square" },
        { "value": "rounded", "label": "Rounded" }
      ],
      "default": "rounded"
    },
    {
      "type": "checkbox",
      "id": "enable_shadow",
      "label": "Enable Card Shadow",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_hover_effect",
      "label": "Enable Hover Effect",
      "default": true
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "gap_size",
      "label": "Gap Between Cards (px)",
      "min": 10,
      "max": 60,
      "step": 2,
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding Top (px)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding Bottom (px)",
      "min": 0,
      "max": 100,
      "step": 5,
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "collection_block",
      "name": "Collection",
      "settings": [
        { "type": "image_picker", "id": "block_image", "label": "Image" },
        { "type": "text", "id": "block_title", "label": "Display Name" },
        { "type": "url", "id": "block_link", "label": "Collection Link" }
      ]
    }
  ],
  "presets": [
    { "name": "Popular Categories Column", "category": "Custom Sections" }
  ]
}
{% endschema %}

<div class="popular-categories-wrapper"
     style="background-color: {{ section.settings.background_color }};
            padding-top: {{ section.settings.padding_top }}px;
            padding-bottom: {{ section.settings.padding_bottom }}px;">
  
  {% if section.settings.section_title != blank %}
    <h2 class="section-heading text-{{ section.settings.title_alignment }}"
        style="font-size: {{ section.settings.title_size }}px; color: {{ section.settings.title_color }};">
      {{ section.settings.section_title }}
    </h2>
  {% endif %}

  <div class="categories-column" style="gap: {{ section.settings.gap_size }}px;">
    {% for block in section.blocks %}
      <div class="category-card {% if section.settings.enable_shadow %}with-shadow{% endif %} {% if section.settings.enable_hover_effect %}hover-effect{% endif %}">
        <a href="{{ block.settings.block_link }}" class="category-link">
          {% if block.settings.block_image %}
            <img 
              src="{{ block.settings.block_image | image_url: width: section.settings.image_size }}" 
              alt="{{ block.settings.block_title }}"
              style="width: {{ section.settings.image_size }}px; height: {{ section.settings.image_size }}px;"
              class="category-image {{ section.settings.image_shape }}">
          {% endif %}
          <p class="category-title"
             style="color: {{ section.settings.text_color }}; font-size: {{ section.settings.title_font_size }}px;">
            {{ block.settings.block_title }}
          </p>
        </a>
      </div>
    {% endfor %}
  </div>
</div>

<style>
.section-heading {
  margin-bottom: 30px;
  font-weight: 600;
}
.categories-column {
  display: flex;
  flex-direction: column;
}
.category-card {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 15px;
  border-radius: 12px;
  transition: all 0.3s ease;
}
.category-card.with-shadow {
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}
.category-card.hover-effect:hover {
  transform: translateY(-5px);
}
.category-link {
  display: flex;
  align-items: center;
  gap: 20px;
  text-decoration: none;
  width: 100%;
}
.category-image.circle { border-radius: 50%; object-fit: cover; }
.category-image.square { border-radius: 0; object-fit: cover; }
.category-image.rounded { border-radius: 12px; object-fit: cover; }
.category-title {
  margin: 0;
  font-weight: 500;
}
@media (max-width: 768px) {
  .category-card {
    gap: 15px;
    padding: 12px;
  }
  .category-title {
    font-size: 14px !important;
  }
}
</style>
